以下是由AI整理后的需求，额外补充了一些信息

# AI智能代码生成软件需求文档

软件功能：AI辅助智能代码生成系统，用户输入需求即可自动生成各种DSL模型文件，用户可以进行局部调整，最后点击生成即可生成一个完整应用
技术背景：单体应用，Java Web应用，面向一般技术人员。

#### **1. 业务目标与范围**

- **核心价值**
  缩短DSL建模到应用生成的周期，降低技术门槛
  通过AI生成可调整的DSL模型，输出完整应用
- **范围边界**
  ✅ 包含：需求输入 → AI生成DSL → 可视化编辑 → 应用生成 → 结果导出/下载
  ❌ 不包含：
  - 版本协作/用户权限管理
  - 应用部署/移动端支持
  - 团队协作功能

#### 核心需求
1. 用户选择建立一个AI生成任务，每个任务可以从已有的任务作为模板来创建。通过prototype_id属性记录它的模板任务。
2. 每个任务具有一个子任务模型列表，为每种子任务指定一个不同的AI模型。比如生成orm使用deepseek-r1模型，生成java使用其他模型。每种任务可以选择不同的模型。任务种类通过一个sub_task_category表定义。
3. 通过模型列表管理第三方模型服务，内部使用时通过model的name来引用，不用使用model id关联。
4. 需求管理按照 系统需求 - 模块需求 - 用例需求 三级管理，模块具有树形结构
5. 所有的表名都以NopAi为前缀，比如NopAiUseCase， 或者nop_ai_use_case。


-------------以下是AI自动整理的需求文档--------------

### 结构化需求文档

---

#### **1. 业务目标与范围**
| **需求编号** | **需求描述**                            | **来源**         | **类型** | **优先级** | **验收标准** |
|-------------|---------------------------------------|----------------|--------|----------|------------|
| BR1         | 缩短DSL建模到应用生成的周期，降低技术门槛       | 1.核心价值       | 业务目标  | 高        | -          |
| BR2         | 通过AI生成可调整的DSL模型，输出完整应用         | 1.核心价值       | 业务目标  | 高        | -          |
| SR1         | 包含流程：需求输入 → AI生成DSL → 可视化编辑 → 应用生成 → 结果导出/下载 | 1.范围边界       | 范围     | 高        | -          |
| SR2         | 不包含：版本协作/用户权限管理、应用部署/移动端支持、团队协作功能 | 1.范围边界       | 范围     | -        | -          |

---

#### **2. 用户角色与场景**
| **角色**       | **使用场景**                           | **关键需求**               | **待澄清问题**                     |
|---------------|--------------------------------------|--------------------------|----------------------------------|
| 技术工程师      | 快速生成原型应用，通过调整DSL模型完善           | 实时预览生成结果              | 技术背景需掌握SQL和JavaScript         |
| 数据分析师      | 创建报表模板DSL                        | 自然语言需求示例库             | 无需角色权限，底层框架统一处理权限问题      |
| 需求分析工程师   | 细化原始需求，设计业务用例和测试用例             | AI生成结果支持重新生成或改进       | 需团队共享功能                     |

---

#### **3. 核心功能需求**
##### **3.1 智能需求输入**
| **需求编号** | **需求描述**                            | **来源** | **类型** | **优先级** | **验收标准** |
|-------------|---------------------------------------|--------|--------|----------|------------|
| FR1.1       | 支持输入方式：自然语言/结构化表单/关键词标签       | 3.1    | 功能    | 高        | -          |
| FR1.2       | 支持Markdown/Excel文件导入              | 3.1-Q4 | 功能    | 中        | -          |
| FR1.3       | 多轮需求澄清机制：AI生成初步版本后提供改进按钮       | 3.1-Q5 | 功能    | 高        | -          |
| FR1.4       | 支持多AI模型并行生成同一提示词，版本评分（百分制）    | 3.1-Q5 | 功能    | 中        | -          |

##### **3.2 AI生成DSL模型**
| **需求编号** | **需求描述**                            | **来源** | **类型** | **优先级** | **验收标准** |
|-------------|---------------------------------------|--------|--------|----------|------------|
| FR2.1       | 支持生成语言：SQL/Java/JavaScript/XML/YAML/Markdown/自定义DSL | 3.2    | 功能    | 高        | -          |
| FR2.2       | 采用第三方AI API，需模型管理模块（弱关联modelName） | 3.2-Q7 | 功能    | 高        | -          |
| FR2.3       | 生成代码编译通过率 ≥95%                    | 3.2    | 功能    | 高        | -          |
| FR2.4       | 支持分部分生成并自动检查/修正DSL              | 3.2    | 功能    | 高        | -          |

##### **3.3 模型编辑与调整**
| **需求编号** | **需求描述**                            | **来源** | **类型** | **优先级** | **验收标准** |
|-------------|---------------------------------------|--------|--------|----------|------------|
| FR3.1       | 无需实时预览，生成后重新渲染可视化             | 3.3-Q8 | 功能    | 中        | -          |
| FR3.2       | 内置版本管理及差异比较工具                 | 3.3-Q9 | 功能    | 高        | -          |

##### **3.4 应用生成与导出**
| **需求编号** | **需求描述**                            | **来源** | **类型** | **优先级** | **验收标准** |
|-------------|---------------------------------------|--------|--------|----------|------------|
| FR4.1       | 输出类型：Web服务/批处理作业/API端点         | 3.4    | 功能    | 高        | -          |
| FR4.2       | 基于Nop低代码平台生成DSL                 | 3.4-Q10| 功能    | 高        | -          |
| FR4.3       | 生成的DSL以zip包下载到本地               | 3.4-Q11| 功能    | 高        | -          |
| AC1         | 输入“创建信用卡调额服务”生成数据库定义及后台服务流程DSL | 3.4    | 验收标准 | 高        | Gherkin示例 |

---

#### **4. 非功能性需求**
| **类型** | **需求编号** | **具体指标**                            | **问题/决策**                              |
|--------|-------------|---------------------------------------|------------------------------------------|
| 性能    | NFR1.1      | DSL生成可异步执行，无时间限制                 | Q12：响应时间可调整                           |
|        | NFR1.2      | 应用生成在24小时内完成                     | -                                        |
| 安全性   | NFR2.1      | 输入内容无需过滤XSS/SQL注入                 | Q14：无需用户认证                           |
|        | NFR2.2      | 提供独立AI安全扫描功能（检测DSL层漏洞）          | Q15：漏洞库内置规则                          |
| 可用性   | NFR3.1      | 内置DSL语法帮助（基于xdef元模型）             | Q16：帮助文档由AI生成                         |
|        | NFR3.2      | 支持DSL导出离线编辑（低优先级）               | Q17：离线功能优先级低                        |
| 可靠性   | NFR4.1      | 生成应用可用性校验：自动生成测试用例及模拟数据       | -                                        |
|        | NFR4.2      | 编译通过率≥95%                        | -                                        |

---

#### **5. 技术约束**
| **需求编号** | **约束内容**                     | **来源** | **类型** |
|-------------|------------------------------|--------|--------|
| TC1         | 后端架构：基于Nop平台的Web单体应用       | 5      | 技术约束 |
| TC2         | 前端框架：Vue3 + Monaco Editor + AMIS | 5      | 技术约束 |
| TC3         | 浏览器兼容性无要求                  | 5-Q20  | 技术约束 |
| TC4         | 依赖Java 17+环境                | 5      | 技术约束 |

---

#### **6. 集成与扩展**
| **类别**     | **需求编号** | **需求描述**                            | **问题/决策**                    |
|------------|-------------|---------------------------------------|--------------------------------|
| 认证集成     | IE1         | 无需考虑，底层平台统一处理                     | MVP必需                        |
| AI模型扩展   | IE2         | 支持GPT/Claude/本地模型（REST调用）           | Q23：通过后端模型链接调用             |
| 工程化集成    | IE3         | 无需预留Jenkins等API                     | Q24：所有API自动开放               |
| 降级方案     | IE4         | AI失败时支持手动录入/修改DSL（生成新版本）         | Q25：任何AI生成内容均可手工编辑         |

---

#### **7. 数据管理**
| **需求编号** | **需求描述**                            | **来源** | **类型** | **优先级** |
|-------------|---------------------------------------|--------|--------|----------|
| DM1         | 用户DSL文件持久化存储到数据库                 | 7      | 数据    | 高        |
| DM2         | 需求结构化存储：生成细化需求并按章节分解             | 7      | 数据    | 高        |
| DM3         | 无需敏感数据处理（如数据库密码）                 | 7      | 数据    | -        |
| DM4         | DSL文件无需加密存储                      | 7      | 数据    | -        |

---

#### **8. 用户体验关键点**
| **需求编号** | **需求描述**                            | **来源** | **类型** | **优先级** |
|-------------|---------------------------------------|--------|--------|----------|
| UX1         | 错误处理格式：JSON包含错误类型、位置及修复建议        | 8      | 体验    | 高        |
| UX2         | 编辑完成后点击保存更新渲染（非实时同步）             | 8      | 体验    | 中        |
| UX3         | DSL支持多格式查看（HTML/XML/Excel等）         | 8      | 体验    | 中        |
| UX4         | 记录AI交互过程（不含用户操作细节），支持缓存标记       | 8      | 体验    | 高        |

---

#### **9. 假设与依赖**
| **需求编号** | **假设内容**                     | **来源** | **类型** |
|-------------|------------------------------|--------|--------|
| AS1         | AI服务可用性≥99%                | 9      | 假设    |
| AS2         | DSL模板约束降低AI幻觉              | 9      | 假设    |
| AS3         | 无需考虑第三方AI响应延迟              | 9      | 假设    |

---

#### **补充说明（05-需求分析反馈）**
##### **AI生成与模型管理**
| **需求编号** | **需求描述**                            | **来源** | **类型** | **决策** |
|-------------|---------------------------------------|--------|--------|--------|
| SUP1        | DSL模块划分由NOP预定义（orm.xml, api.xml等） | Q1     | 功能    | 无需用户干预 |
| SUP2        | 跨模块一致性通过元数据（app:useCaseNo等）保证     | Q2     | 功能    | 提示词包含关联信息 |
| SUP3        | AI评分维度：正确性/性能/可读性/合规性           | Q3     | 功能    | 待定    |
| SUP4        | 测试用例由AI生成，支持人工维护               | Q4     | 功能    | -      |

##### **核心功能细节**
| **需求编号** | **需求描述**                            | **来源** | **类型** | **决策** |
|-------------|---------------------------------------|--------|--------|--------|
| SUP5        | Excel导入无需预定义模板（Nop通用解析）         | Q5     | 功能    | -      |
| SUP6        | Markdown按标题层级自动分解需求             | Q6     | 功能    | -      |
| SUP7        | 版本管理不处理跨DSL依赖（由逻辑编排配置协调）       | Q7     | 功能    | -      |

> **规范说明**：
> 1. **原始信息完整性**：严格依据文档内容提取，未新增假设或删减细节。
> 2. **结构化字段**：
     >    - **需求编号**：按章节+序号分级（如FR2.1=功能需求3.2节第1条）。
>    - **来源**：标注原始文档章节及问题编号（如3.1-Q4）。
>    - **类型**：业务目标(BR)/范围(SR)/功能(FR)/非功能(NFR)/技术约束(TC)等。
>    - **待澄清问题**：保留文档中的SA反馈（如Q1-Q25）。
