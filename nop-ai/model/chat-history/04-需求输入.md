以下是根据`03-综合分析框架`初步填写的结果

# AI智能代码生成软件需求文档

软件功能：AI辅助智能代码生成系统，用户输入需求即可自动生成各种DSL模型文件，用户可以进行局部调整，最后点击生成即可生成一个完整应用
技术背景：单体应用，Java Web应用，面向一般技术人员。

#### **1. 业务目标与范围**

- **核心价值**
  缩短DSL建模到应用生成的周期，降低技术门槛
  通过AI生成可调整的DSL模型，输出完整应用
- **范围边界**
  ✅ 包含：需求输入 → AI生成DSL → 可视化编辑 → 应用生成 → 结果导出/下载
  ❌ 不包含：
  - 版本协作/用户权限管理
  - 应用部署/移动端支持
  - 团队协作功能

---

#### **2. 用户角色与场景**

| 角色      | 使用场景                        | 关键需求                         | 待澄清问题（SA）                        |
|---------|-----------------------------|------------------------------|----------------------------------|
| 技术工程师   | 快速生成原型应用，并可以通过调整DSL模型来进行完善  | 实时预览生成结果                     | 技术背景？掌握SQL和JavaScript            |
| 数据分析师   | 创建报表模板DSL                   | 自然语言需求示例库                    | 是否需要角色权限？不需要考虑权限问题，底层框架将统一解决权限问题 |
| 需求分析工程师 | 对用户输入的原始需求进行细化，并设计业务用例和测试用例 | AI初步生成结果，用户可以选择重新生成或者让AI尝试改进 | *是否需团队共享？* 需要                    |

---

#### **3. 核心功能需求**

**3.1 智能需求输入**

- 支持方式：自然语言/结构化表单/关键词标签（
- 问题清单：
  - Q4: 是否支持文件导入（Markdown/Excel）？支持Markdown文件和Excel模型文件的导入
  - Q5: 是否需多轮需求澄清（AI追问模糊点）？
    每个DSL都是AI自动生成初步版本，然后提供一系列按钮，让客户选择是否让AI继续改进。改进过程会产生一系列历史版本，用户可以选择最终使用哪个版本。
    用户还可以选择同时用不同的AI模型针对同一个提示词执行生成。每个DSL模型应该有一个评分，可以由AI模型对不同版本进行评分，百分制。

**3.2 AI生成DSL模型**

- 支持语言：SQL/Java/JavaScript/XML/YAML/Markdown/自定义DSL
- 关键决策：
  - Q7: AI服务采用第三方API（OpenAI）或自研模型？
    采用第三方API，需要有一个模型管理模块。每个模型有一个内部使用的name，每个生成的DSL都记录这个modelName，但是并不需要和模型对象建立关联，这是一种弱联系。
  - 可靠性要求：生成代码编译通过率 ≥95% 。因为是生成DSL，可以自动根据元模型对DSL进行检查和进行局部更正，并且可以主动控制DSL的复杂程度。比如每次让AI生成并检查DSL的一个部分。

**3.3 模型编辑与调整**

- 问题清单：
  - Q8: 是否需实时预览调整效果？不需要可视化编辑。每个DSL都配备有对应的可视化查看工具，生成后重新渲染即可。
  - Q9: 是否支持版本回滚/差异对比？需要内置版本管理功能，并且提供内置的差异比较工具。

**3.4 应用生成与导出**

- 输出类型：Web服务/批处理作业/API端点
- 技术栈：
  - Q10: 是否强制Spring Boot/React等？并不使用这些框架，底层基于Nop低代码平台，在这个平台中开发只需要编写各类DSL
  - Q11: 压缩包下载或直推Git仓库？生成的DSL存放在数据库中，按照目录结构管理，可以作为zip包下载到本地。

- 验收标准示例：
  ```gherkin
  当 输入“创建一个信用卡调额服务”
  则 生成数据库定义以及对应的后台服务流程DSL
  ```

---

#### **4. 非功能性需求**

| 类型  | 具体指标                                                                     | 问题清单（SA）                                       |
|-----|--------------------------------------------------------------------------|------------------------------------------------|
| 性能  | DSL生成响应不限制时间，可以异步执行                                                      | Q12: 响应阈值是否可调整？因为需求可能比较复杂，不强制要求即时生成            |
|     | 应用生成在24小时以内完成                                                            |                                                |
| 安全性 | 输入内容过滤XSS/SQL注入等问题不需要考虑                                                  | Q14: 是否需用户认证？              不需要考虑这个问题，底层框架会统一处理 |
|     | *AI生成的代码需要提供一个安全扫描功能*                                                    | Q15: 漏洞扫描深度？ AI自动判断是否存在安全漏洞，将这个作为一个独立功能点       |
| 可用性 | *内置DSL语法帮助*，DSL使用xdef元模型来进行语法自动校验，并提供语法提示                                | Q16: 帮助文档覆盖范围？由AI自动生成使用文档，这也是一个独立的功能点          |
|     | *离线编辑支持*                       ， DSL可以导出后离线编辑                            | Q17: 离线功能优先级？            离线功能优先级很低             |
| 可靠性 | 生成应用最低可用标准？ 自动生成测试用例来进行校验。因为底层基于NopORM引擎，所以可以让AI自动生成所有数据库模拟数据，和API请求响应消息 | *编译通过率≥95%*                                    |

---

#### **5. 技术约束**

- 后端架构：基于Nop平台的Web单体应用
- 前端框架：
  - 推荐：Vue3 + Monaco Editor + AMIS前端低代码
  - 约束：是否强制特定技术？强制要求使用以上技术
- 兼容性：
  - Q20: 浏览器兼容要求？不用考虑
- 依赖：Java 17+环境

---

#### **6. 集成与扩展**

| 类别     | 需求                                               | 问题清单                             |
|--------|--------------------------------------------------|----------------------------------|
| 认证集成   | 不需要考虑，底层平台统一处理                                   | 是否MVP必需？是                        |
| AI模型扩展 | 支持GPT/Claude/本地模型                                | Q23: 插件机制设计？ 通过后端管理的模型链接进行REST调用 |
| 工程化集成  | 预留API接入点（如Jenkins）？不需要考虑这个问题                     | Q24: API开放范围？所有API都会自动开放         |
| 降级方案   | AI失败时提供手动DSL模板？是的，可以手工直接录入DSL，或者手工修改，修改要产生新的历史版本 | Q25: 降级触发条件？ 任何AI自动生成内容都可以手工编辑   |

---

#### **7. 数据管理**

- 存储策略：
  - 用户DSL文件是否持久化？保存到数据库中
  - 需求历史记录保存需求？需求本身需要进行结构化管理。需要首先根据用户输入的简短需求生成一个完整细化的需求，并按照章节分解保存，然后针对每个功能模块生成一系列用例，再根据用例生成API定义和实现等。
- 安全规范：
  - 敏感数据处理（如数据库密码）？不需要考虑这些问题，由底层框架统一处理。
  - DSL文件加密存储要求？不需要存储加密

---

#### **8. 用户体验关键点**

- 错误处理机制：
  ```json
  {
    "error_type": "SYNTAX_ERROR",
    "position": { "line": 12, "column": 5 },
    "suggested_fix": "Missing closing bracket"
  }
  ```
- 交互设计：
  - 实时预览与编辑同步？
    目前编辑完成后点击保存再更新渲染。一个DSL可能存在多种展现形式，比如orm.xml可以用Html表格形式查看，可以用XML格式查看，可以下载Excel格式的模型文件等。不同的DSL文件对应不同的view，这个由内置的配置文件来控制。
  - *用户操作轨迹记录（用于优化AI）*？
    所有AI交互过程都需要详细记录，这独立于DSL的版本记录。并且AI交互消息还需要定义一个可缓存标记，缺省为true，如果发现同样的prompt，则直接返回缓存结果。如果可缓存标记设置为false，则不会将它作为结果返回。

---

#### **9. 假设与依赖**

- 关键依赖：
  - AI服务可用性 ≥99% ？ 可以假定AI服务永远可用。
  - DSL模板约束降低AI幻觉
- 风险假设：
  - 高频需求模板缓存失效
  - 第三方AI服务响应延迟？不用考虑

